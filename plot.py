import matplotlib.pyplot as plt
import time
import datetime
# plt.plot([5, 10, 15, 20, 25, 30, 35], [1772, 3542, 5310, 6072, 6194, 4278, 2240])
# plt.xlabel('No. of games')
# hero

# plt.plot([0, 0, 0, 10, 277, 581, 677, 564, 683, 490, 685, 1015, 1678, 1301, 1233, 1827, 1296, 1642, 1302, 871, 544, 398, 0, 0, 0, 0, 0, 0, 0, 0])

#input_start = 2019-06-14T10:04:13.607Z

input = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19500, 18100, 23100, 30300, 38700, 38000, 44100, 41700, 33687, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 392344, 452652, 494465, 523778, 44499, 0, 0, 0, 0, 0, 0, 0, 0, 15565, 310410, 31800, 31800, 30500, 27300, 23300, 21600, 24400, 26900, 25600, 23900, 24600, 29700, 32300, 27000, 25100, 26100, 30300, 34900, 36800, 28100, 38800, 40000, 37500, 34700, 30800, 32500, 27800, 36600, 40300, 45800, 50100, 51000, 46200, 49500, 49800, 52400, 49300, 50700, 58900, 59800, 59300, 52100, 56500, 56100, 49700, 49800, 57200, 58600, 52200, 52100, 47700, 52800, 59000, 53500, 49900, 46700, 48900, 42319, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 366162, 274319, 52800, 56200, 50100, 45300, 53500, 47400, 52500, 41800, 47900, 45400, 47700, 51200, 55800, 55400, 46700, 46700, 45700, 48800, 52600, 52100, 48800, 52100, 53100, 52800, 47100, 44700, 46800, 44400, 46200, 52100, 50300, 49600, 51200, 49900, 47700, 55500, 51100, 52300, 53200, 56600, 53600, 49100, 55200, 61300, 58200, 51100, 48700, 55400, 57200, 56400, 50300, 51900, 50900, 48200, 47700, 49600, 53000, 53800, 53000, 59400, 60600, 59000, 56500, 54800, 56200, 58100, 62700, 62100, 61200, 57400, 47500, 53700, 50500, 55900, 50100, 49700, 48700, 54000, 53500, 48900, 49200, 51400, 46500, 43500, 46300, 51100, 53400, 59100, 53800, 55900, 56600, 54000, 52200, 49800, 55200, 44100, 53000, 50500, 54900, 55900, 54300, 45200, 47900, 49200, 48800, 44000, 47900, 50200, 42100, 45400, 51800, 53600, 51400, 55700, 56700, 46500, 54400, 50800, 53000, 57200, 50700, 47100, 53600, 54800, 48900, 50400, 55800, 57100, 49800, 50200, 46000, 52000, 47800, 53000, 56700, 57600, 57300, 53200, 55600, 59000, 52300, 52800, 49700, 53000, 51900, 59400, 58400, 55900, 53500, 50300, 52600, 50500, 49600, 52800, 52000, 44900, 55600, 54500, 51500, 61200, 60300, 50900, 49100, 49800, 54700, 54400, 51700, 50400, 57900, 52800, 45400, 52000, 52100, 50000, 49900, 41600, 44700, 45500, 47200, 48300, 47200, 43400, 41300, 45700, 49400, 56200, 53700, 59200, 54900, 55900, 55800, 50900, 40000, 47300, 40100, 44900, 41800, 46600, 49500, 51600, 55000, 55500, 47000, 45300, 42200, 47400, 50800, 45200, 50900, 55500, 51300, 50200, 52500, 62300, 50100, 51500, 48700, 45100, 49300, 50100, 45300, 49300, 52400, 49300, 58400, 54600, 50100, 51600, 52800, 48200, 54000, 58200, 60700, 56200, 48900, 47900, 50200, 52300, 46100, 41000, 45200, 46600, 46400, 43400, 44200, 45000, 39600, 47800, 50000, 43800, 45100, 51300, 52300, 41400, 44700, 48800, 49700, 60600, 58000, 63600, 67000, 55500, 58300, 60500, 64100, 59200, 57400, 64700, 64000, 60500, 56100, 55400, 60000, 58200, 55100, 55500, 48900, 51400, 57700, 54700, 51700, 53700, 45800, 49900, 55500, 48000, 45900, 44900, 40900, 49500, 49000, 48900, 47100, 50000, 43700, 40300, 51500, 50200, 47100, 48700, 51400, 51100, 58100, 56800, 58900, 60800, 53000, 48200, 54300, 54300, 52700, 55400, 55300, 52900, 56700, 53100, 52000, 40310, 59690, 57000, 60700, 54100, 58600, 50100, 56300, 54900, 58000, 53000, 58000, 56500, 51300, 44900, 45400, 49600, 40300, 43800, 45800, 43700, 52400, 51500, 48600, 47400, 48400, 46200, 47200, 48100, 53200, 49800, 56600, 55600, 53100, 58100, 48300, 52400, 48800, 44100, 46100, 43400, 48400, 43300, 50500, 43800, 44200, 45300, 36900, 44700, 46000, 56900, 59100, 59000, 61500, 52700, 54700, 56300, 50100, 52100, 50500, 46300, 45300, 51400, 46100, 42400, 44400, 47100, 47500, 45700, 44800, 43900, 44100, 41700, 51200, 50900, 47300, 52600, 53400, 49200, 50300, 49600, 18309, 84491, 49200, 55800, 53500, 54000, 50800, 54600, 51100, 43200, 37700, 46700, 43800, 41200, 46400, 41900, 46600, 52300, 41100, 40200, 35800, 39400, 39400, 43200, 38100, 38400, 46300, 45600, 47200, 44500, 42500, 42300, 41100, 41500, 40300, 39300, 37700, 48700, 48200, 38300, 43000, 41000, 42900, 45300, 47000, 53100, 43000, 50500, 57600, 58500, 51600, 49900, 48800, 51400, 49300, 52700, 49200, 50100, 50800, 51700, 56600, 53800, 49700, 52300, 50000, 56600, 53800, 53300, 47300, 59200, 62400, 55100, 49900, 47800, 52500, 54600, 58600, 55300, 52100, 54800, 51200, 50300, 49400, 50300, 1994, 0, 0, 0, 0, 0, 0, 0, 0, 513706, 60500, 53900, 57200, 53300, 49500, 47900, 48500, 52000, 54400, 56300, 60200, 61100, 53700, 57700, 54700, 57600, 50800, 51200, 49500, 45100, 49900, 46800, 48700, 51000, 48300, 51900, 50600, 45900, 36400, 39400, 41200, 43600, 45800, 49300, 48000, 41600, 47400, 47200, 56200, 55000, 50700, 55100, 48500, 54000, 55200, 45200, 44300, 45100, 43500, 44300, 47600, 46200, 50700, 48000, 53400, 50500, 47700, 50300, 49800, 58600, 55500, 47900, 51300, 29819, 77281, 55700, 60600, 48700, 55700, 54100, 52700, 52600, 54300, 53700, 62000, 59100, 54000, 53800, 53200, 50500, 51100, 57700, 52800, 63600, 59700, 57800, 56200, 56500, 58000, 54600, 51700, 57600, 50900, 50400, 55900, 54100, 56800, 48400, 48600, 52600, 57300, 56200, 60300, 57200, 57100, 59900, 55400, 55000, 43200, 48300, 55200, 61100, 62200, 61100, 55500, 54100, 55900, 55800, 54800, 59400, 60500, 56900, 56600, 55600, 52500, 55400, 58200, 54600, 54900, 59200, 57700, 56300, 51000, 57900, 53200, 55700, 44338, 68862, 54000, 59700, 56500, 60000, 54700, 57100, 60600, 58500, 54300, 60900, 56600, 58700, 57100, 62000, 57200, 53800, 53100, 54900, 57500, 56500, 53100, 55800, 54000, 56800, 55800, 56800, 51200, 53800, 51800, 46800, 46200, 52800, 54500, 56100, 51800, 53100, 51000, 46400, 48900, 54900, 45800, 44900, 36700, 30400, 40400, 35000, 38800, 35700, 41700, 49000, 50600, 47600, 35200, 36300, 38900, 37300, 37300, 42400, 42700, 43100, 39500, 41800, 41200, 47000, 42900, 47900, 44600, 45900, 51100, 45300, 49300, 52100, 53600, 49800, 49200, 45700, 48700, 54800, 53800, 35781, 0, 0, 0, 0, 0, 0, 0, 0, 419273, 120346, 49800, 47000, 42200, 42300, 43400, 41700, 47400, 51600, 47400, 54300, 48300, 45400, 52500, 56300, 53800, 49500, 45700, 50800, 50100, 59900, 57600, 61700, 53900, 56600, 51500, 54000, 53900, 50400, 44700, 56100, 53900, 54000, 53200, 57800, 53700, 58300, 57200, 55200, 53300, 55100, 50800, 57100, 51600, 49200, 49400, 45100, 41400, 44800, 41800, 39400, 37900, 39100, 33600, 33200, 38100, 42900, 42600, 45300, 47300, 42300, 48200, 43500, 49200, 40000, 40000, 38500, 31700, 33600, 30800, 27600, 30900, 26061, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 103659, 312880, 36900, 32400, 26000, 23700, 37900, 37100, 32600, 28300, 41600, 33200, 31800, 29400, 32500, 29200, 30600, 31300, 38400, 29300, 34900, 29600, 31600, 31900, 33300, 35500, 38400, 32600, 29500, 30700, 35100, 29800, 32000, 25800, 31900, 31200, 32100, 39400, 33400, 13100, 11600, 12600, 12100, 11400, 11400, 11900, 11700, 11500, 10800, 10600, 10200, 10300, 10000, 10300, 10200, 10200, 10200, 10900, 10400, 10500, 10400, 10600, 10700, 10400, 10300, 10000, 10600, 10100, 10300, 10000, 10400, 9800, 10100, 10700, 10600, 10000, 10300, 10400, 10700, 10100, 10300, 10400, 10600, 10200, 10200, 10600, 9500, 9000, 9100, 9400, 9100, 9400, 9000, 9100, 9400, 9100, 9100, 9400, 9100, 9000, 9200, 9000, 9500, 8900, 9200, 9100, 9500, 9000, 8900, 9200, 9400, 9100, 9000, 9300, 9200, 9200, 8900, 9200, 9400, 9200, 8900, 8900, 9400, 8900, 8900, 9100, 8900, 8900, 8600, 8700, 9200, 8600, 8700, 9000, 8800, 8700, 8800, 8900, 8800, 8600, 8700, 8900, 9000, 8600, 9300, 8900, 8700, 9000, 8800, 9100, 8700, 8900, 9300, 8600, 9000, 8700, 8900, 9000, 8900, 8800, 8700, 9300, 8800, 8800, 8800, 9100, 8800, 8800, 9200, 8700, 8800, 8900, 9100, 8800, 8800, 9100, 9400, 8900, 9000, 8900, 9500, 9000, 8800, 600]

input = [0] * 23 + input

# input_sum = [-1] * int(len(input) / 10)
# for i in range(int(len(input) / 10)):
#     for j in range(10):
#         input_sum[i] += input[i * 10 + j]






logs = []
isCur = True
currPos = 0
f = open("throughput.txt", "r")
for x in f:
    timestamp = x.split(",")[0]
    records = x.split(",")[1]
    logs.append((datetime.datetime.strptime(timestamp, '%Y-%m-%dT%H:%M:%S.%fZ'), records))

startTimeStamp = time.mktime(logs[0][0].timetuple())
endTimeStamp = time.mktime(logs[len(logs) - 1][0].timetuple())

print(logs[0][0], logs[len(logs) - 1][0])
print(startTimeStamp, endTimeStamp)

output_sum = [0] * (int((endTimeStamp - startTimeStamp) / 10) + 1)
print(len(output_sum))

for log in logs:
    pos = int((time.mktime(log[0].timetuple()) - startTimeStamp) / 10)
    output_sum[pos] += int(log[1])

output = []
for i in range(len(output_sum)):
    for j in range(10):
        output.append(output_sum[i] / 10)

plt.plot(input, label='Data replayer')
plt.plot(output, label='Streaming engine')
plt.xlabel("Seconds into Analysis")
plt.ylabel("Number of Records")
plt.legend()

print(sum(input))
print(sum(output))

plt.show()
